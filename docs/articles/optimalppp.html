<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Optimal Project Prioritization Protocol • optimalppp</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Optimal Project Prioritization Protocol">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">optimalppp</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/optimalppp.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/prioritizr/optimalppp">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Optimal Project Prioritization Protocol</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/prioritizr/optimalppp/blob/master/vignettes/optimalppp.Rmd"><code>vignettes/optimalppp.Rmd</code></a></small>
      <div class="hidden name"><code>optimalppp.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>The <em>optimalppp R</em> package provides methods for prioritizing funding of conservation projects using the ‘Protect Prioritization Protocol’. A range of methods are provided for identifying priority projects for funding. These include exact algorithm solvers which can identify optimal solutions, and also stingy heuristic algorithms that have conventionally been used to identify suboptimal solutions. This package also provides the functionality to visualize how well solutions maintain biodiversity.</p>
</div>
<div id="tutorial" class="section level2">
<h2 class="hasAnchor">
<a href="#tutorial" class="anchor"></a>Tutorial</h2>
<p>Here we will provide a short example showing how the <em>optimalppp R</em> package can be used to prioritize funding for conservation projects. With limited resources available for conservation <span class="citation">(Balmford <em>et al.</em> 2003)</span>, it is imperative that funds are prioritized for conservation projects which will the greatest outcome. This realization led to development of the ‘Project Prioritization Protocol’ <span class="citation">(Joseph <em>et al.</em> 2009)</span>. This method involves evaluating conservation projects according to (i) the probability that they are expected to succeed, (ii) the probability that species’ will persist if they are funded and succeed, and (iii) the amount of evolutionary history that is retained by the conserved species. Although several formulations exist for parameterizing evolutionary history <span class="citation">(evaluated in Bennett <em>et al.</em> 2014)</span>, one approach is the ‘expected phylogenetic diversity’ metric <span class="citation">(Faith 1992, 2008)</span>. Here, the <em>optimalppp R</em> package uses the expected phylogenetic diversity exclusively to assess how well different funding schemes preserve the evolutionary history in a given area. This package provides several methods for generating and evaluating solutions based on this metric. Notably, it can use exact algorithms (via <a href="http://gurobi.com/">Gurobi</a>) to identify solutions that are guaranteed to be optimal.</p>
<p>To start off, we will set the seed for the random number generator to ensure you get the same results as shown here, set some default behavior for the <em>R</em> session, load the <em>optimalppp R</em> package, and load the <em>ggtree R</em> package to plot phylogenetic trees. Please note that you will need install the <em>ggtree</em> separately from Bioconductor since they are not on the Comprehensive R Archive Network (CRAN). This can be achieved with the following command <code>source("https://bioconductor.org/biocLite.R");biocLite("ggtree")</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">700</span>)
<span class="kw">library</span>(optimalppp)
<span class="kw">library</span>(ggtree)</code></pre></div>
<p>Now we will simulate a data set. This data set will contain conservations projects for 50 species and also phylogenetic data that describe the evolutionary relationships between them. To learn more about what these parameters mean, check out the help page for the <code>ppp_simulate_data</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set simulation parameters</span>
number_species &lt;-<span class="st"> </span><span class="dv">50</span>
cost_mean &lt;-<span class="st"> </span><span class="dv">100</span>
cost_sd &lt;-<span class="st"> </span><span class="dv">5</span>
success_min_probability &lt;-<span class="st"> </span><span class="fl">0.7</span>
success_max_probability &lt;-<span class="st"> </span><span class="fl">0.99</span>
funded_min_persistence_probability &lt;-<span class="st"> </span><span class="fl">0.5</span>
funded_max_persistence_probability &lt;-<span class="st"> </span><span class="fl">0.9</span>
not_funded_min_persistence_probability &lt;-<span class="st"> </span><span class="fl">0.01</span>
not_funded_max_persistence_probability &lt;-<span class="st"> </span><span class="fl">0.4</span>
locked_in_proportion &lt;-<span class="st"> </span><span class="fl">0.1</span>
locked_out_proportion &lt;-<span class="st"> </span><span class="fl">0.1</span>

<span class="co"># simulate data</span>
sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ppp_simulate_data.html">ppp_simulate_data</a></span>(number_species,
                         cost_mean,
                         cost_sd,
                         success_min_probability,
                         success_max_probability,
                         funded_min_persistence_probability,
                         funded_max_persistence_probability,
                         not_funded_min_persistence_probability,
                         not_funded_max_persistence_probability,
                         locked_in_proportion,
                         locked_out_proportion)

<span class="co"># extract conservation project data and phylogenetic data</span>
sim_project_data &lt;-<span class="st"> </span>sim<span class="op">$</span>project_data
sim_tree &lt;-<span class="st"> </span>sim<span class="op">$</span>tree</code></pre></div>
<p>Let’s visualize the evolutionary relationships between the simulated species.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot tree</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/ggtree/topics/ggtree">ggtree</a></span>(sim_tree) <span class="op">+</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/ggtree/topics/geom_tiplab">geom_tiplab</a></span>(<span class="dt">size =</span> <span class="fl">2.5</span>)</code></pre></div>
<p><img src="optimalppp_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Next, we will load the <code>sim_project_data</code> object. This object stores information about various conservation projects in a tabular format (i.e. <code>tibble</code>). Each row corresponds to a different project, and each column describes various properties associated with the projects. Importantly, the <code>"name"</code> column contains the name of each project, the <code>"cost"</code> column contains the cost of each project, the <code>"success"</code> column denotes the probability of each project succeeding if it is funded, and the <code>"S1"</code>–<code>"S50"</code> columns show the enhanced probability of each species persisting if the project is funded. It also contains additional columns, but we will ignore them for now. Note that the last project—the <code>"baseline_project"</code>—has a zero cost and represents the baseline probability of each species persisting if no other project is funded. Finally, though most projects in this example directly relate to a single species, you can input projects that directly affect the persistence of multiple species.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># print project data</span>
<span class="kw">print</span>(sim_project_data)</code></pre></div>
<pre><code>## # A tibble: 51 x 55
##    name   cost success locked_in locked_out    S1   S10   S11   S12   S13
##    &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;lgl&gt;     &lt;lgl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 S1_p…  99.6   0.981 FALSE     FALSE      0.860 0     0     0     0    
##  2 S2_p…  98.9   0.744 FALSE     TRUE       0     0.680 0     0     0    
##  3 S3_p…  99.6   0.722 FALSE     FALSE      0     0     0.855 0     0    
##  4 S4_p…  91.3   0.969 FALSE     FALSE      0     0     0     0.664 0    
##  5 S5_p… 105.    0.885 FALSE     FALSE      0     0     0     0     0.585
##  6 S6_p…  98.9   0.793 FALSE     FALSE      0     0     0     0     0    
##  7 S7_p… 108.    0.874 FALSE     FALSE      0     0     0     0     0    
##  8 S8_p…  95.5   0.710 FALSE     FALSE      0     0     0     0     0    
##  9 S9_p…  96.0   0.947 FALSE     FALSE      0     0     0     0     0    
## 10 S10_…  95.5   0.781 FALSE     TRUE       0     0     0     0     0    
## # ... with 41 more rows, and 45 more variables: S14 &lt;dbl&gt;, S15 &lt;dbl&gt;,
## #   S16 &lt;dbl&gt;, S17 &lt;dbl&gt;, S18 &lt;dbl&gt;, S19 &lt;dbl&gt;, S2 &lt;dbl&gt;, S20 &lt;dbl&gt;,
## #   S21 &lt;dbl&gt;, S22 &lt;dbl&gt;, S23 &lt;dbl&gt;, S24 &lt;dbl&gt;, S25 &lt;dbl&gt;, S26 &lt;dbl&gt;,
## #   S27 &lt;dbl&gt;, S28 &lt;dbl&gt;, S29 &lt;dbl&gt;, S3 &lt;dbl&gt;, S30 &lt;dbl&gt;, S31 &lt;dbl&gt;,
## #   S32 &lt;dbl&gt;, S33 &lt;dbl&gt;, S34 &lt;dbl&gt;, S35 &lt;dbl&gt;, S36 &lt;dbl&gt;, S37 &lt;dbl&gt;,
## #   S38 &lt;dbl&gt;, S39 &lt;dbl&gt;, S4 &lt;dbl&gt;, S40 &lt;dbl&gt;, S41 &lt;dbl&gt;, S42 &lt;dbl&gt;,
## #   S43 &lt;dbl&gt;, S44 &lt;dbl&gt;, S45 &lt;dbl&gt;, S46 &lt;dbl&gt;, S47 &lt;dbl&gt;, S48 &lt;dbl&gt;,
## #   S49 &lt;dbl&gt;, S5 &lt;dbl&gt;, S50 &lt;dbl&gt;, S6 &lt;dbl&gt;, S7 &lt;dbl&gt;, S8 &lt;dbl&gt;, S9 &lt;dbl&gt;</code></pre>
<p>Let us assume that our resources are limited such that we can only spend, at most, $500 on funding conservation projects. In other words, our budget is capped at $500. Now, given the project data (<code>sim_project_data</code>), the species’ evolutionary relationships (<code>sim_tree</code>), and this budget (<code>500</code>), we can begin prioritizing funding for the conservation projects. Conventionally, conservation projects have been prioritized using heuristic algorithms <span class="citation">(e.g. Bennett <em>et al.</em> 2014)</span>, so let’s generate our first prioritization using this method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># prioritize funding using stingy heuristic algorithm</span>
s1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ppp_heuristic_solution.html">ppp_heuristic_solution</a></span>(<span class="dt">x =</span> sim_project_data, <span class="dt">tree =</span> sim_tree,
                             <span class="dt">budget =</span> <span class="dv">500</span>, <span class="dt">project_column_name =</span> <span class="st">"name"</span>,
                             <span class="dt">cost_column_name =</span> <span class="st">"cost"</span>,
                             <span class="dt">success_column_name =</span> <span class="st">"success"</span>)

<span class="co"># print solution</span>
<span class="kw">print</span>(s1)</code></pre></div>
<pre><code>## # A tibble: 1 x 57
##   objective budget  cost optimal method S1_project S2_project S3_project
##       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;   &lt;chr&gt;  &lt;lgl&gt;      &lt;lgl&gt;      &lt;lgl&gt;     
## 1      7.53    500  487. NA      heuri… FALSE      FALSE      FALSE     
## # ... with 49 more variables: S4_project &lt;lgl&gt;, S5_project &lt;lgl&gt;,
## #   S6_project &lt;lgl&gt;, S7_project &lt;lgl&gt;, S8_project &lt;lgl&gt;,
## #   S9_project &lt;lgl&gt;, S10_project &lt;lgl&gt;, S11_project &lt;lgl&gt;,
## #   S12_project &lt;lgl&gt;, S13_project &lt;lgl&gt;, S14_project &lt;lgl&gt;,
## #   S15_project &lt;lgl&gt;, S16_project &lt;lgl&gt;, S17_project &lt;lgl&gt;,
## #   S18_project &lt;lgl&gt;, S19_project &lt;lgl&gt;, S20_project &lt;lgl&gt;,
## #   S21_project &lt;lgl&gt;, S22_project &lt;lgl&gt;, S23_project &lt;lgl&gt;,
## #   S24_project &lt;lgl&gt;, S25_project &lt;lgl&gt;, S26_project &lt;lgl&gt;,
## #   S27_project &lt;lgl&gt;, S28_project &lt;lgl&gt;, S29_project &lt;lgl&gt;,
## #   S30_project &lt;lgl&gt;, S31_project &lt;lgl&gt;, S32_project &lt;lgl&gt;,
## #   S33_project &lt;lgl&gt;, S34_project &lt;lgl&gt;, S35_project &lt;lgl&gt;,
## #   S36_project &lt;lgl&gt;, S37_project &lt;lgl&gt;, S38_project &lt;lgl&gt;,
## #   S39_project &lt;lgl&gt;, S40_project &lt;lgl&gt;, S41_project &lt;lgl&gt;,
## #   S42_project &lt;lgl&gt;, S43_project &lt;lgl&gt;, S44_project &lt;lgl&gt;,
## #   S45_project &lt;lgl&gt;, S46_project &lt;lgl&gt;, S47_project &lt;lgl&gt;,
## #   S48_project &lt;lgl&gt;, S49_project &lt;lgl&gt;, S50_project &lt;lgl&gt;,
## #   baseline_project &lt;lgl&gt;, solution &lt;int&gt;</code></pre>
<p>The object <code>s1</code> contains the solution and also various statistics associated with the solution in a tabular format (i.e. <code>tibble</code>). Here, each row corresponds to a different solution. Specifically, the <code>"solution"</code> column contains an identifier for the solution (this is useful for methods that output multiple solutions), the <code>"objective"</code> column contains the objective value (i.e. the expected phylogenetic diversity, Faith 2008), the <code>"budget"</code> column stores the budget used for generating the solution, the <code>"cost"</code> column stores the cost of the solution, the <code>"optimal"</code> column indicates if the solution is known to be optimal (<code>NA</code> values mean the optimality is unknown), and the <code>"method"</code> column contains the name of the method used to generate the solution. The remaining columns (<code>"S1_project"</code>, <code>"S2_project"</code>, <code>"S3_project"</code>, …, <code>"S50_project"</code>, and <code>"baseline_project"</code>) indicate if a given project was prioritized for funding in the solution or not.</p>
<p>Here, the objective value (in the <code>"objective"</code> column) denotes the amount of evolutionary history that is expected to persist (i.e. 7.527 million years). Put simply, solutions that are expected to result in better conservation outcomes will be associated with a greater objective value. Since tabular data can be difficult to intuit, let’s visualize how well this solution would maintain the different branches in the phylogeny. Note that species which receive any funding are denoted with an asterisk.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># visualize solution</span>
<span class="kw"><a href="../reference/ppp_plot.html">ppp_plot</a></span>(sim_project_data, sim_tree, s1, <span class="dt">project_column_name =</span> <span class="st">"name"</span>,
         <span class="dt">cost_column_name =</span> <span class="st">"cost"</span>, <span class="dt">success_column_name =</span> <span class="st">"success"</span>,
         <span class="dt">asterisk_hjust =</span> <span class="fl">0.01</span>)</code></pre></div>
<p><img src="optimalppp_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>In some cases, we might have projects for iconic species that are socially and economically important for conservation. To ensure that for projects these species are funded–regardless of cost-efficiency or evolutionary benefit—we can “lock in” certain projects into the solution (conversely, we can also “lock out” certain projects if desired). Let us imagine that it is absolutely critical that the project for species S1 (named <code>"S1_project"</code>) receive funding. We can then generate another solution using the stingy heuristic algorithm with this constraint.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set locked in column to only lock in species S3</span>
sim_project_data<span class="op">$</span>locked_in &lt;-<span class="st"> </span>sim_project_data<span class="op">$</span>name <span class="op">==</span><span class="st"> "S1_project"</span>

<span class="co"># prioritize funding using stingy heuristic algorithm</span>
s2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ppp_heuristic_solution.html">ppp_heuristic_solution</a></span>(<span class="dt">x =</span> sim_project_data, <span class="dt">tree =</span> sim_tree,
                             <span class="dt">budget =</span> <span class="dv">500</span>, <span class="dt">project_column_name =</span> <span class="st">"name"</span>,
                             <span class="dt">cost_column_name =</span> <span class="st">"cost"</span>,
                             <span class="dt">success_column_name =</span> <span class="st">"success"</span>,
                             <span class="dt">locked_in_column_name =</span> <span class="st">"locked_in"</span>)

<span class="co"># print solution</span>
<span class="kw">print</span>(s2)</code></pre></div>
<pre><code>## # A tibble: 1 x 57
##   objective budget  cost optimal method S1_project S2_project S3_project
##       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;   &lt;chr&gt;  &lt;lgl&gt;      &lt;lgl&gt;      &lt;lgl&gt;     
## 1      7.41    500  489. NA      heuri… TRUE       FALSE      FALSE     
## # ... with 49 more variables: S4_project &lt;lgl&gt;, S5_project &lt;lgl&gt;,
## #   S6_project &lt;lgl&gt;, S7_project &lt;lgl&gt;, S8_project &lt;lgl&gt;,
## #   S9_project &lt;lgl&gt;, S10_project &lt;lgl&gt;, S11_project &lt;lgl&gt;,
## #   S12_project &lt;lgl&gt;, S13_project &lt;lgl&gt;, S14_project &lt;lgl&gt;,
## #   S15_project &lt;lgl&gt;, S16_project &lt;lgl&gt;, S17_project &lt;lgl&gt;,
## #   S18_project &lt;lgl&gt;, S19_project &lt;lgl&gt;, S20_project &lt;lgl&gt;,
## #   S21_project &lt;lgl&gt;, S22_project &lt;lgl&gt;, S23_project &lt;lgl&gt;,
## #   S24_project &lt;lgl&gt;, S25_project &lt;lgl&gt;, S26_project &lt;lgl&gt;,
## #   S27_project &lt;lgl&gt;, S28_project &lt;lgl&gt;, S29_project &lt;lgl&gt;,
## #   S30_project &lt;lgl&gt;, S31_project &lt;lgl&gt;, S32_project &lt;lgl&gt;,
## #   S33_project &lt;lgl&gt;, S34_project &lt;lgl&gt;, S35_project &lt;lgl&gt;,
## #   S36_project &lt;lgl&gt;, S37_project &lt;lgl&gt;, S38_project &lt;lgl&gt;,
## #   S39_project &lt;lgl&gt;, S40_project &lt;lgl&gt;, S41_project &lt;lgl&gt;,
## #   S42_project &lt;lgl&gt;, S43_project &lt;lgl&gt;, S44_project &lt;lgl&gt;,
## #   S45_project &lt;lgl&gt;, S46_project &lt;lgl&gt;, S47_project &lt;lgl&gt;,
## #   S48_project &lt;lgl&gt;, S49_project &lt;lgl&gt;, S50_project &lt;lgl&gt;,
## #   baseline_project &lt;lgl&gt;, solution &lt;int&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># visualize solution</span>
<span class="kw"><a href="../reference/ppp_plot.html">ppp_plot</a></span>(sim_project_data, sim_tree, s2, <span class="dt">project_column_name =</span> <span class="st">"name"</span>,
         <span class="dt">cost_column_name =</span> <span class="st">"cost"</span>, <span class="dt">success_column_name =</span> <span class="st">"success"</span>)</code></pre></div>
<p><img src="optimalppp_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Next, we might want to evaluate how well this solution compares to selecting projects at random. To achieve this, we need to generate solutions that contain randomly selected projects that (i) always include the baseline scenario project, and (ii) meet the budget. Fortunately, the <code>ppp_random_solution</code> function does this for us. So, let’s generate 500 random solutions with a budget of $500.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># prioritize funding using stingy heuristic algorithm</span>
s3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ppp_random_solution.html">ppp_random_solution</a></span>(<span class="dt">x =</span> sim_project_data, <span class="dt">tree =</span> sim_tree,
                          <span class="dt">budget =</span> <span class="dv">500</span>, <span class="dt">project_column_name =</span> <span class="st">"name"</span>,
                          <span class="dt">cost_column_name =</span> <span class="st">"cost"</span>,
                          <span class="dt">success_column_name =</span> <span class="st">"success"</span>,
                          <span class="dt">locked_in_column_name =</span> <span class="st">"locked_in"</span>,
                          <span class="dt">number_solutions =</span> <span class="dv">500</span>)

<span class="co"># print solution</span>
<span class="kw">print</span>(s3)</code></pre></div>
<pre><code>## # A tibble: 500 x 57
##    solution objective budget  cost optimal method S1_project S2_project
##       &lt;int&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;   &lt;chr&gt;  &lt;lgl&gt;      &lt;lgl&gt;     
##  1        1      6.84    500  495. NA      random TRUE       FALSE     
##  2        2      6.87    500  498. NA      random TRUE       FALSE     
##  3        3      6.69    500  403. NA      random TRUE       FALSE     
##  4        4      6.72    500  401. NA      random TRUE       FALSE     
##  5        5      6.86    500  403. NA      random TRUE       FALSE     
##  6        6      6.61    500  407. NA      random TRUE       FALSE     
##  7        7      6.45    500  395. NA      random TRUE       FALSE     
##  8        8      6.61    500  416. NA      random TRUE       FALSE     
##  9        9      6.64    500  497. NA      random TRUE       TRUE      
## 10       10      6.79    500  496. NA      random TRUE       FALSE     
## # ... with 490 more rows, and 49 more variables: S3_project &lt;lgl&gt;,
## #   S4_project &lt;lgl&gt;, S5_project &lt;lgl&gt;, S6_project &lt;lgl&gt;,
## #   S7_project &lt;lgl&gt;, S8_project &lt;lgl&gt;, S9_project &lt;lgl&gt;,
## #   S10_project &lt;lgl&gt;, S11_project &lt;lgl&gt;, S12_project &lt;lgl&gt;,
## #   S13_project &lt;lgl&gt;, S14_project &lt;lgl&gt;, S15_project &lt;lgl&gt;,
## #   S16_project &lt;lgl&gt;, S17_project &lt;lgl&gt;, S18_project &lt;lgl&gt;,
## #   S19_project &lt;lgl&gt;, S20_project &lt;lgl&gt;, S21_project &lt;lgl&gt;,
## #   S22_project &lt;lgl&gt;, S23_project &lt;lgl&gt;, S24_project &lt;lgl&gt;,
## #   S25_project &lt;lgl&gt;, S26_project &lt;lgl&gt;, S27_project &lt;lgl&gt;,
## #   S28_project &lt;lgl&gt;, S29_project &lt;lgl&gt;, S30_project &lt;lgl&gt;,
## #   S31_project &lt;lgl&gt;, S32_project &lt;lgl&gt;, S33_project &lt;lgl&gt;,
## #   S34_project &lt;lgl&gt;, S35_project &lt;lgl&gt;, S36_project &lt;lgl&gt;,
## #   S37_project &lt;lgl&gt;, S38_project &lt;lgl&gt;, S39_project &lt;lgl&gt;,
## #   S40_project &lt;lgl&gt;, S41_project &lt;lgl&gt;, S42_project &lt;lgl&gt;,
## #   S43_project &lt;lgl&gt;, S44_project &lt;lgl&gt;, S45_project &lt;lgl&gt;,
## #   S46_project &lt;lgl&gt;, S47_project &lt;lgl&gt;, S48_project &lt;lgl&gt;,
## #   S49_project &lt;lgl&gt;, S50_project &lt;lgl&gt;, baseline_project &lt;lgl&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># visualize solution</span>
<span class="kw"><a href="../reference/ppp_plot.html">ppp_plot</a></span>(sim_project_data, sim_tree, s3, <span class="dt">project_column_name =</span> <span class="st">"name"</span>,
         <span class="dt">cost_column_name =</span> <span class="st">"cost"</span>, <span class="dt">success_column_name =</span> <span class="st">"success"</span>, <span class="dt">n =</span> <span class="dv">2</span>,
         <span class="dt">asterisk_hjust =</span> <span class="fl">0.01</span>)</code></pre></div>
<p><img src="optimalppp_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can now calculate how much better the solution generated using the stingy heuristic algorithm performs than random.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate how much better solution performs than random</span>
s2<span class="op">$</span>objective <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(s3<span class="op">$</span>objective)</code></pre></div>
<pre><code>## [1] 0.7142387</code></pre>
<p>Since the stingy heuristic algorithm performs much better than random, you might be thinking that the stingy heuristic algorithm is pretty good. But you would be wrong. This is because the heuristic algorithms provide no guarantees on solution quality relative to optimality. In other words, the objective value tells us how good the solution is, but it does not tell us how good the solution is compared to the best possible solution. Therefore we cannot possibly be confident that the solution is any good at all. Fortunately, we can use exact algorithms to find the optimal solution to this problem <span class="citation">(for discussion on exact algorithms in conservation, see Underhill 1994; Rodrigues &amp; Gaston 2002)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># prioritize funding using stingy heuristic algorithm</span>
s4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ppp_exact_solution.html">ppp_exact_solution</a></span>(<span class="dt">x =</span> sim_project_data, <span class="dt">tree =</span> sim_tree,
                         <span class="dt">budget =</span> <span class="dv">500</span>, <span class="dt">project_column_name =</span> <span class="st">"name"</span>,
                         <span class="dt">cost_column_name =</span> <span class="st">"cost"</span>,
                         <span class="dt">success_column_name =</span> <span class="st">"success"</span>,
                         <span class="dt">locked_in_column_name =</span> <span class="st">"locked_in"</span>)

<span class="co"># print solution</span>
<span class="kw">print</span>(s4)</code></pre></div>
<pre><code>## # A tibble: 1 x 57
##   solution objective budget  cost optimal method S1_project S2_project
##      &lt;int&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;   &lt;chr&gt;  &lt;lgl&gt;      &lt;lgl&gt;     
## 1        1      7.42    500  494. TRUE    exact  TRUE       FALSE     
## # ... with 49 more variables: S3_project &lt;lgl&gt;, S4_project &lt;lgl&gt;,
## #   S5_project &lt;lgl&gt;, S6_project &lt;lgl&gt;, S7_project &lt;lgl&gt;,
## #   S8_project &lt;lgl&gt;, S9_project &lt;lgl&gt;, S10_project &lt;lgl&gt;,
## #   S11_project &lt;lgl&gt;, S12_project &lt;lgl&gt;, S13_project &lt;lgl&gt;,
## #   S14_project &lt;lgl&gt;, S15_project &lt;lgl&gt;, S16_project &lt;lgl&gt;,
## #   S17_project &lt;lgl&gt;, S18_project &lt;lgl&gt;, S19_project &lt;lgl&gt;,
## #   S20_project &lt;lgl&gt;, S21_project &lt;lgl&gt;, S22_project &lt;lgl&gt;,
## #   S23_project &lt;lgl&gt;, S24_project &lt;lgl&gt;, S25_project &lt;lgl&gt;,
## #   S26_project &lt;lgl&gt;, S27_project &lt;lgl&gt;, S28_project &lt;lgl&gt;,
## #   S29_project &lt;lgl&gt;, S30_project &lt;lgl&gt;, S31_project &lt;lgl&gt;,
## #   S32_project &lt;lgl&gt;, S33_project &lt;lgl&gt;, S34_project &lt;lgl&gt;,
## #   S35_project &lt;lgl&gt;, S36_project &lt;lgl&gt;, S37_project &lt;lgl&gt;,
## #   S38_project &lt;lgl&gt;, S39_project &lt;lgl&gt;, S40_project &lt;lgl&gt;,
## #   S41_project &lt;lgl&gt;, S42_project &lt;lgl&gt;, S43_project &lt;lgl&gt;,
## #   S44_project &lt;lgl&gt;, S45_project &lt;lgl&gt;, S46_project &lt;lgl&gt;,
## #   S47_project &lt;lgl&gt;, S48_project &lt;lgl&gt;, S49_project &lt;lgl&gt;,
## #   S50_project &lt;lgl&gt;, baseline_project &lt;lgl&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># visualize solution</span>
<span class="kw"><a href="../reference/ppp_plot.html">ppp_plot</a></span>(sim_project_data, sim_tree, s4, <span class="dt">project_column_name =</span> <span class="st">"name"</span>,
         <span class="dt">cost_column_name =</span> <span class="st">"cost"</span>, <span class="dt">success_column_name =</span> <span class="st">"success"</span>,
         <span class="dt">asterisk_hjust =</span> <span class="fl">0.01</span>)</code></pre></div>
<p><img src="optimalppp_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Now that we have the optimal solution (objective value = 7.42 million years of expected evolutionary history), we can see that the solution generated by the stingy heuristic algorithm (objective value = 7.412 million years of expected evolutionary history) was indeed suboptimal.</p>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<p><strong>This repository is still under active development. It is not yet ready for use.</strong></p>
<p>Please use the following citation to cite the <em>optimalppp R</em> package in publications:</p>
<p>Hanson JO, Schuster R, Strimas-Mackey M, Bennett J, (2018). optimalppp: Optimal Project Prioritization Protocol. R package version 0.0.0.1. Available at <a href="https://github.com/prioritizr/optimalppp" class="uri">https://github.com/prioritizr/optimalppp</a>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-r2">
<p>Balmford, A., Gaston, K.J., Blyth, S., James, A. &amp; Kapos, V. (2003). Global variation in terrestrial conservation costs, conservation benefits, and unmet conservation needs. <em>Proceedings of the National Academy of Sciences</em>, <em>100</em>, 1046–1050.</p>
</div>
<div id="ref-r4">
<p>Bennett, J.R., Elliott, G., Mellish, B., Joseph, L.N., Tulloch, A.I., Probert, W.J., Di Fonzo, M.M., Monks, J.M., Possingham, H.P. &amp; Maloney, R. (2014). Balancing phylogenetic diversity and species numbers in conservation prioritizat, using a case study of threatened species in New Zealand. <em>Biological Conservation</em>, <em>174</em>, 47–54.</p>
</div>
<div id="ref-r9">
<p>Faith, D.P. (1992). Conservation evaluation and phylogenetic diversity. <em>Biological Conservation</em>, <em>61</em>, 1–10.</p>
</div>
<div id="ref-r8">
<p>Faith, D.P. (2008). Threatened species and the potential loss of phylogenetic diversity: Conservation scenarios based on estimated extinction probabilities and phylogenetic risk analysis. <em>Conservation Biology</em>, <em>22</em>, 1461–1470.</p>
</div>
<div id="ref-r3">
<p>Joseph, L.N., Maloney, R.F. &amp; Possingham, H.P. (2009). Optimal allocation of resources among threatened species: A project prioritization protocol. <em>Conservation Biology</em>, <em>23</em>, 328–338.</p>
</div>
<div id="ref-r13">
<p>Rodrigues, A.S. &amp; Gaston, K.J. (2002). Optimisation in reserve selection procedures—why not? <em>Biological Conservation</em>, <em>107</em>, 123–129.</p>
</div>
<div id="ref-r12">
<p>Underhill, L. (1994). Optimal and suboptimal reserve selection algorithms. <em>Biological Conservation</em>, <em>70</em>, 85–87.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#overview">Overview</a></li>
      <li><a href="#tutorial">Tutorial</a></li>
      <li><a href="#citation">Citation</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://jeffrey-hanson.com">Jeffrey O Hanson</a>, <a href="http://www.richard-schuster.com/">Richard Schuster</a>, <a href="http://strimas.com">Matthew Strimas-Mackey</a>, <a href="https://josephrbennett.wordpress.com/">Joeseph Bennett</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
